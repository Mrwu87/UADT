{"version":"4.3","rules":[{"id":"rule:910138","rawsql":"SELECT\n\n  payload,\n  payload.vin as vin\n\nFROM\n\n  \"/efence_k8s_backend/tracking\"","actions":[{"id":"republish_1652863510584639831","name":"republish","fallbacks":[],"args":{"target_topic":"/efence_k8s_backend/${vin}/tracking","target_qos":0,"payload_tmpl":"${payload}"}}],"enabled":true,"description":"tracking+=${vin}"},{"id":"rule:753224","rawsql":"SELECT\n\n  payload\n\nFROM\n\n  \"/efence_k8s_backend/agent_version\"","actions":[{"id":"data_to_mqtt_broker_1652863510674762469","name":"data_to_mqtt_broker","fallbacks":[],"args":{"payload_tmpl":"${payload}","forward_topic":"/UcloudKubernetes/jiashan-dw-prod/efence_k8s_backend/agent_version","$resource":"resource:606779"}}],"enabled":true,"description":"/efence_k8s_backend/agent_version"},{"id":"rule:469157","rawsql":"SELECT\n\n  payload,\n  payload.vin as vin\n\nFROM\n\n  \"/efence_k8s_backend/error_info\"","actions":[{"id":"republish_1652863510590367745","name":"republish","fallbacks":[],"args":{"target_topic":"/efence_k8s_backend/${vin}/error_info","target_qos":0,"payload_tmpl":"${payload}"}}],"enabled":true,"description":"error_info+={vin}"},{"id":"rule:717203","rawsql":"SELECT\n\n  payload,\n  payload.vin as vin\n\nFROM\n\n  \"/efence_k8s_backend/nome_state\"","actions":[{"id":"republish_1652863510604737402","name":"republish","fallbacks":[],"args":{"target_topic":"/efence_k8s_backend/${vin}/nome_state","target_qos":0,"payload_tmpl":"${payload}"}}],"enabled":true,"description":"nome_state+=${vin}"},{"id":"rule:586358","rawsql":"SELECT\n  publish_received_at,\n  payload as payload,\n  payload.run_scene as run_scene,\n  payload.channel as channel,\n  payload.vin as vin,\n  payload.params.time as params_time,\n  int(payload.params.time * 1000000000) as new_timestamp,\n  payload.params.content.code as code,\n  payload.params.content.mark as mark,\n  payload.params.content.node as node\n\nFROM\n\n  \"/efence_k8s_backend/source_event\"","actions":[{"id":"data_to_influxdb_1652863510612749305","name":"data_to_influxdb","fallbacks":[],"args":{"timestamp":"${new_timestamp}","tags":{"vin":"${vin}","run_scene":"${run_scene}","node":"${node}","mark":"${mark}","code":"${code}","channel":"${channel}"},"measurement":"source_event","fields":{"publish_received_at":"${publish_received_at}","payload":"${payload}","params_time":"${params_time}"},"enable_batch":true,"$resource":"resource:741830"}}],"enabled":true,"description":"source_event"},{"id":"rule:712513","rawsql":"SELECT\n\n  payload,\n  payload.vin as vin\n\nFROM\n\n  \"/efence_k8s_backend/efu/nome_state\"","actions":[{"id":"republish_1652863510627746530","name":"republish","fallbacks":[],"args":{"target_topic":"/efence_k8s_backend/efu/${vin}/nome_state","target_qos":0,"payload_tmpl":"${payload}"}}],"enabled":true,"description":"efu/nome_state+=${vin}"},{"id":"rule:362588","rawsql":"SELECT\n  payload as payload,\n  publish_received_at,\n  payload.timestamp as inner_timestamp,\n  int(payload.timestamp * 1000000000) as new_timestamp,\n  payload.vin as vin,\n  payload.params.recover_state as recover_state,\n  payload.params.node as node,\n  payload.params.recover_countdown as recover_countdown\n\n\nFROM\n\n  \"/efence_k8s_backend/nome_state\"","actions":[{"id":"data_to_influxdb_1652863510634451824","name":"data_to_influxdb","fallbacks":[],"args":{"timestamp":"${new_timestamp}","tags":{"vin":"${vin}","recover_state":"${recover_state}","recover_countdown":"${recover_countdown}","node":"${node}"},"measurement":"nome_state","fields":{"publish_received_at":"${publish_received_at}","payload":"${payload}","inner_timestamp":"${inner_timestamp}"},"enable_batch":true,"$resource":"resource:741830"}}],"enabled":true,"description":"nome_state"},{"id":"rule:263449","rawsql":"SELECT\n  publish_received_at,\n  payload as payload,\n  payload.run_scene as run_scene,\n  payload.channel as channel,\n  payload.vin as vin,\n  payload.params.time as params_time,\n  int(payload.params.time * 1000000000) as new_timestamp,\n  payload.params.status.service_mode as service_mode,\n  payload.params.content.node as node,\n  payload.params.content.mark as mark,\n  payload.params.content.nome_level as nome_level\n\n\nFROM\n\n  \"/efence_k8s_backend/source_nome\"","actions":[{"id":"data_to_influxdb_1652863510646668965","name":"data_to_influxdb","fallbacks":[],"args":{"timestamp":"${new_timestamp}","tags":{"vin":"${vin}","service_mode":"${service_mode}","run_scene":"${run_scene}","nome_level":"${nome_level}","node":"${node}","mark":"${mark}","channel":"${channel}"},"measurement":"source_nome","fields":{"publish_received_at":"${publish_received_at}","payload":"${payload}","params_time":"${params_time}"},"enable_batch":true,"$resource":"resource:741830"}}],"enabled":true,"description":"source_nome"}],"resources":[{"id":"resource:606779","type":"bridge_mqtt","config":{"address":"ota-emqx.kube-public.svc.cluster.local:1883","append":true,"bridge_mode":false,"cacertfile":{"filename":"","file":""},"certfile":{"filename":"","file":""},"ciphers":"ECDHE-ECDSA-AES256-GCM-SHA384,ECDHE-RSA-AES256-GCM-SHA384,ECDHE-ECDSA-AES256-SHA384,ECDHE-RSA-AES256-SHA384,ECDHE-ECDSA-DES-CBC3-SHA,ECDH-ECDSA-AES256-GCM-SHA384,ECDH-RSA-AES256-GCM-SHA384,ECDH-ECDSA-AES256-SHA384,ECDH-RSA-AES256-SHA384,DHE-DSS-AES256-GCM-SHA384,DHE-DSS-AES256-SHA256,AES256-GCM-SHA384,AES256-SHA256,ECDHE-ECDSA-AES128-GCM-SHA256,ECDHE-RSA-AES128-GCM-SHA256,ECDHE-ECDSA-AES128-SHA256,ECDHE-RSA-AES128-SHA256,ECDH-ECDSA-AES128-GCM-SHA256,ECDH-RSA-AES128-GCM-SHA256,ECDH-ECDSA-AES128-SHA256,ECDH-RSA-AES128-SHA256,DHE-DSS-AES128-GCM-SHA256,DHE-DSS-AES128-SHA256,AES128-GCM-SHA256,AES128-SHA256,ECDHE-ECDSA-AES256-SHA,ECDHE-RSA-AES256-SHA,DHE-DSS-AES256-SHA,ECDH-ECDSA-AES256-SHA,ECDH-RSA-AES256-SHA,AES256-SHA,ECDHE-ECDSA-AES128-SHA,ECDHE-RSA-AES128-SHA,DHE-DSS-AES128-SHA,ECDH-ECDSA-AES128-SHA,ECDH-RSA-AES128-SHA,AES128-SHA","clientid":"client","disk_cache":"off","keepalive":"60s","keyfile":{"filename":"","file":""},"mountpoint":"bridge/aws/${node}/","password":"compass","pool_size":8,"proto_ver":"mqttv4","reconnect_interval":"30s","retry_interval":"20s","ssl":false,"username":"compass","verify":false},"created_at":1632396241118,"description":""},{"id":"resource:741830","type":"backend_influxdb_http","config":{"batch_size":1000,"cacertfile":{"filename":"","file":""},"certfile":{"filename":"","file":""},"database":"emqx_ee","host":"emqx-influxdb-latest","https_enabled":false,"keyfile":{"filename":"","file":""},"password":"","pool_size":8,"port":8086,"precision":"ns","tls_version":"tlsv1.2","username":"","verify":false},"created_at":1629801653328,"description":"纳秒"}],"blacklist":[],"apps":[{"id":"admin","secret":"public","name":"Default","desc":"Application user","status":true,"expired":"undefined"}],"users":[{"username":"admin","password":"aXE1rFtpziJOyvuJLAJ/C1XeTAY=","tags":"administrator"}],"auth_mnesia":[],"acl_mnesia":[],"modules":[{"id":"module:55dffbcc","type":"retainer","config":{"storage_type":"ram","max_retained_messages":0,"max_payload_size":"1MB","expiry_interval":0},"enabled":true,"created_at":"undefined","description":""},{"id":"module:a3b17a89","type":"mysql_authentication","config":{"verify":false,"user":"root","super_query":"select is_superuser from mqtt_user where username = '%u' limit 1","ssl":false,"server":"compass-mysql-latest:3306","query_timeout":"5s","pool_size":8,"password_hash":"sha256","password":"uisee@2019","keyfile":{"filename":"","file":""},"database":"emqtt","certfile":{"filename":"","file":""},"cacertfile":{"filename":"","file":""},"auto_reconnect":true,"auth_query":"select password from mqtt_user where '%u' like concat('%', username, '%') limit 1","acl_query":"select allow, ipaddr, username, clientid, access, topic from mqtt_acl where ipaddr = '%a' or username = '%u' or username = '$all' or clientid = '%c'"},"enabled":true,"created_at":1632657217083,"description":""},{"id":"module:9ec52537","type":"http_authentication","config":{"verify":false,"super_req_params":"","super_req":"","ssl":false,"req_content_type":"application/x-www-form-urlencoded","pool_size":8,"method":"POST","keyfile":{"filename":"","file":""},"http_opts_timeout":"5s","http_opts_retry_times":5,"http_opts_retry_interval":"1s","http_opts_connect_timeout":"5s","http_headers":{"Content-Type":"application/x-www-form-urlencoded"},"certfile":{"filename":"","file":""},"cacertfile":{"filename":"","file":""},"auth_req_params":"username=%u,password=%P","auth_req":"http://140.207.19.50:32600/cert/","acl_req_params":"","acl_req":""},"enabled":false,"created_at":1629801653307,"description":""},{"id":"module:5d081a13","type":"internal_acl","config":{"acl_rule_file":{"filename":"acl.conf","file":"\n{allow, {user, \"dashboard\"}, subscribe, [\"$SYS/#\"]}. {deny, {user, \"cloud\"}, publish,[\"$SYS/#\",\"#\"]}. {allow, {ipaddr, \"127.0.0.1\"}, pubsub, [\"$SYS/#\", \"#\"]}. {allow, all, subscribe, [\"$SYS/brokers/+/clients/#\"]}. {deny, all, subscribe, [\"$SYS/#\", {eq, \"#\"}]}. {allow, all}.\n"}},"enabled":true,"created_at":"undefined","description":""},{"id":"module:14c2b9a9","type":"recon","config":{},"enabled":true,"created_at":"undefined","description":""},{"id":"module:3a0689a4","type":"presence","config":{"qos":0},"enabled":true,"created_at":"undefined","description":""},{"id":"module:3e8c7dca","type":"mnesia_authentication","config":{"password_hash":"sha256"},"enabled":true,"created_at":1638844446790,"description":""}],"schemas":[],"configs":[{"name":"os_mon","confs":{"cpu_check_interval":"60s","cpu_high_watermark":"80%","cpu_low_watermark":"60%","mem_check_interval":"60s","procmem_high_watermark":"5%","sysmem_high_watermark":"70%"}},{"zone":"internal","confs":{"retry_interval":"null","bypass_auth_plugins":"true","strict_mode":"false","session_expiry_interval":"null","max_topic_levels":"null","max_subscriptions":"0","rate_limit_conn_bytes_in":"null","max_packet_size":"null","idle_timeout":"null","max_mqueue_len":"10000","max_clientid_len":"null","use_username_as_clientid":"null","force_shutdown_policy":"128000|128MB","mqueue_store_qos0":"true","response_information":"null","mqueue_priorities":"null","acl_nomatch":"null","mountpoint":"null","allow_anonymous":"true","ignore_loop_deliver":"false","retain_available":"null","mqueue_default_priority":"null","enable_stats":"on","enable_flapping_detect":"off","keepalive_backoff":"null","quota_overall_messages_routing":"null","enable_ban":"null","shared_subscription":"null","max_awaiting_rel":"1000","max_qos_allowed":"null","max_inflight":"128","upgrade_qos":"null","quota_conn_messages_routing":"null","max_topic_alias":"null","publish_limit":"null","force_gc_policy":"null","server_keepalive":"null","await_rel_timeout":"null","enable_acl":"off","rate_limit_conn_messages_in":"null","wildcard_subscription":"null","acl_deny_action":"ignore"}},{"type":"ws","name":"external","confs":{"acceptors":"16","active_n":"100","backlog":"1024","idle_timeout":"null","listener":"8083","max_conn_rate":"1000","max_connections":"102400","max_frame_size":"null","mqtt_path":"/mqtt","mqtt_piggyback":"multiple","nodelay":"true","peer_cert_as_username":"null","proxy_protocol":"null","proxy_protocol_timeout":"null","rate_limit":"null","recbuf":"null","send_timeout":"15s","send_timeout_close":"on","sndbuf":"null","verify_protocol_header":"on","zone":"external"}},{"type":"tcp","name":"external","confs":{"acceptors":"64","active_n":"100","backlog":"1024","high_watermark":"null","listener":"0.0.0.0:1883","max_conn_rate":"1000","max_connections":"1024000","nodelay":"true","peer_cert_as_username":"null","proxy_protocol":"null","proxy_protocol_timeout":"null","rate_limit":"null","recbuf":"null","reuseaddr":"true","send_timeout":"15s","send_timeout_close":"on","sndbuf":"null","zone":"external"}},{"type":"wss","name":"external","confs":{"send_timeout_close":"on","max_connections":"16","fail_if_no_peer_cert":"null","secure_renegotiate":"null","peer_cert_as_username":"null","proxy_protocol":"null","max_conn_rate":"1000","idle_timeout":"null","rate_limit":"null","mqtt_path":"/mqtt","recbuf":"null","proxy_protocol_timeout":"null","sndbuf":"null","cacertfile":"null","dhfile":"null","ciphers":"ECDHE-ECDSA-AES256-GCM-SHA384,ECDHE-RSA-AES256-GCM-SHA384,ECDHE-ECDSA-AES256-SHA384,ECDHE-RSA-AES256-SHA384,ECDHE-ECDSA-DES-CBC3-SHA,ECDH-ECDSA-AES256-GCM-SHA384,ECDH-RSA-AES256-GCM-SHA384,ECDH-ECDSA-AES256-SHA384,ECDH-RSA-AES256-SHA384,DHE-DSS-AES256-GCM-SHA384,DHE-DSS-AES256-SHA256,AES256-GCM-SHA384,AES256-SHA256,ECDHE-ECDSA-AES128-GCM-SHA256,ECDHE-RSA-AES128-GCM-SHA256,ECDHE-ECDSA-AES128-SHA256,ECDHE-RSA-AES128-SHA256,ECDH-ECDSA-AES128-GCM-SHA256,ECDH-RSA-AES128-GCM-SHA256,ECDH-ECDSA-AES128-SHA256,ECDH-RSA-AES128-SHA256,DHE-DSS-AES128-GCM-SHA256,DHE-DSS-AES128-SHA256,AES128-GCM-SHA256,AES128-SHA256,ECDHE-ECDSA-AES256-SHA,ECDHE-RSA-AES256-SHA,DHE-DSS-AES256-SHA,ECDH-ECDSA-AES256-SHA,ECDH-RSA-AES256-SHA,AES256-SHA,ECDHE-ECDSA-AES128-SHA,ECDHE-RSA-AES128-SHA,DHE-DSS-AES128-SHA,ECDH-ECDSA-AES128-SHA,ECDH-RSA-AES128-SHA,AES128-SHA","reuse_sessions":"null","certfile":"etc/certs/cert.pem","keyfile":"etc/certs/key.pem","active_n":"100","zone":"external","listener":"8084","verify":"null","max_frame_size":"null","nodelay":"null","acceptors":"4","verify_protocol_header":"on","send_timeout":"15s","psk_ciphers":"null","honor_cipher_order":"null","mqtt_piggyback":"multiple","tls_versions":"null","backlog":"1024"}},{"name":"emqx","confs":{"acl_cache_max_size":"32","acl_cache_ttl":"1m","acl_deny_action":"ignore","acl_nomatch":"allow","allow_anonymous":"false","broker_session_locking_strategy":"quorum","broker_shared_dispatch_ack_enabled":"false","broker_shared_subscription_strategy":"random","broker_sys_heartbeat":"30s","broker_sys_interval":"1m","enable_acl_cache":"on","flapping_detect_policy":"30, 1m, 5m","mqtt_ignore_loop_deliver":"false","mqtt_max_clientid_len":"65535","mqtt_max_packet_size":"1MB","mqtt_max_qos_allowed":"2","mqtt_max_topic_alias":"65535","mqtt_max_topic_levels":"0","mqtt_retain_available":"true","mqtt_shared_subscription":"true","mqtt_strict_mode":"false","mqtt_wildcard_subscription":"true"}},{"zone":"external","confs":{"retry_interval":"30s","bypass_auth_plugins":"null","strict_mode":"false","session_expiry_interval":"2h","max_topic_levels":"null","max_subscriptions":"0","rate_limit_conn_bytes_in":"null","max_packet_size":"null","idle_timeout":"15s","max_mqueue_len":"1000","max_clientid_len":"null","use_username_as_clientid":"false","force_shutdown_policy":"10000|32MB","mqueue_store_qos0":"true","response_information":"null","mqueue_priorities":"none","acl_nomatch":"null","mountpoint":"null","allow_anonymous":"null","ignore_loop_deliver":"false","retain_available":"null","mqueue_default_priority":"highest","enable_stats":"on","enable_flapping_detect":"off","keepalive_backoff":"0.75","quota_overall_messages_routing":"null","enable_ban":"on","shared_subscription":"null","max_awaiting_rel":"100","max_qos_allowed":"null","max_inflight":"32","upgrade_qos":"off","quota_conn_messages_routing":"null","max_topic_alias":"null","publish_limit":"null","force_gc_policy":"16000|16MB","server_keepalive":"null","await_rel_timeout":"300s","enable_acl":"on","rate_limit_conn_messages_in":"null","wildcard_subscription":"null","acl_deny_action":"ignore"}},{"name":"vm_mon","confs":{"check_interval":"30s","process_high_watermark":"80%","process_low_watermark":"60%"}},{"type":"tcp","name":"internal","confs":{"acceptors":"4","active_n":"1000","backlog":"512","high_watermark":"null","listener":"127.0.0.1:11883","max_conn_rate":"1000","max_connections":"1024000","nodelay":"false","peer_cert_as_username":"null","proxy_protocol":"null","proxy_protocol_timeout":"null","rate_limit":"null","recbuf":"64KB","reuseaddr":"true","send_timeout":"5s","send_timeout_close":"on","sndbuf":"64KB","zone":"internal"}},{"type":"ssl","name":"external","confs":{"acceptors":"32","active_n":"100","backlog":"null","cacertfile":"/path/cacert.crt","certfile":"/path/cert.crt","ciphers":"ECDHE-ECDSA-AES256-GCM-SHA384,ECDHE-RSA-AES256-GCM-SHA384,ECDHE-ECDSA-AES256-SHA384,ECDHE-RSA-AES256-SHA384,ECDHE-ECDSA-DES-CBC3-SHA,ECDH-ECDSA-AES256-GCM-SHA384,ECDH-RSA-AES256-GCM-SHA384,ECDH-ECDSA-AES256-SHA384,ECDH-RSA-AES256-SHA384,DHE-DSS-AES256-GCM-SHA384,DHE-DSS-AES256-SHA256,AES256-GCM-SHA384,AES256-SHA256,ECDHE-ECDSA-AES128-GCM-SHA256,ECDHE-RSA-AES128-GCM-SHA256,ECDHE-ECDSA-AES128-SHA256,ECDHE-RSA-AES128-SHA256,ECDH-ECDSA-AES128-GCM-SHA256,ECDH-RSA-AES128-GCM-SHA256,ECDH-ECDSA-AES128-SHA256,ECDH-RSA-AES128-SHA256,DHE-DSS-AES128-GCM-SHA256,DHE-DSS-AES128-SHA256,AES128-GCM-SHA256,AES128-SHA256,ECDHE-ECDSA-AES256-SHA,ECDHE-RSA-AES256-SHA,DHE-DSS-AES256-SHA,ECDH-ECDSA-AES256-SHA,ECDH-RSA-AES256-SHA,AES256-SHA,ECDHE-ECDSA-AES128-SHA,ECDHE-RSA-AES128-SHA,DHE-DSS-AES128-SHA,ECDH-ECDSA-AES128-SHA,ECDH-RSA-AES128-SHA,AES128-SHA","depth":"null","dhfile":"null","fail_if_no_peer_cert":"true","handshake_timeout":"15s","high_watermark":"null","honor_cipher_order":"null","keyfile":"/path/key.pem","listener":"8883","max_conn_rate":"500","max_connections":"102400","nodelay":"null","peer_cert_as_username":"cn","proxy_protocol":"null","proxy_protocol_timeout":"null","psk_ciphers":"null","rate_limit":"null","recbuf":"null","reuse_sessions":"null","reuseaddr":"true","secure_renegotiate":"null","send_timeout":"null","send_timeout_close":"null","sndbuf":"null","tls_versions":"null","verify":"true","zone":"external"}}],"listeners_state":[{"type":"ws","name":"external","status":true},{"type":"tcp","name":"external","status":true},{"type":"wss","name":"external","status":true},{"type":"tcp","name":"internal","status":true},{"type":"ssl","name":"external","status":true}],"date":"2022-05-19 01:26:34"}